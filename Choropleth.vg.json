{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": "container",
  "params": [
    {
      "name": "Month_Selection",
      "bind": {
        "input": "select",
        "options": [
          null,
          "January",
          "February",
          "March",
          "April",
          "May",
          "June",
          "July",
          "August",
          "September",
          "October",
          "November",
          "December"
        ],
        "labels": [
          "Annual",
          "January",
          "February",
          "March",
          "April",
          "May",
          "June",
          "July",
          "August",
          "September",
          "October",
          "November",
          "December"
        ],
        "name": "Month Selection"
      }
    },
    {
      "name": "State_Selection",
      "bind": {
        "input": "select",
        "options": [
          null,
          "Queensland",
          "South Australia",
          "New South Wales",
          "Western Australia",
          "Australian Capital Territory",
          "Northern Territory",
          "Tasmania",
          "Victoria"
        ],
        "labels": [
          "All States",
          "Queensland",
          "South Australia",
          "New South Wales",
          "Western Australia",
          "Australian Capital Territory",
          "Northern Territory",
          "Tasmania",
          "Victoria"
        ]
      }
    }
  ],
  "projection": {"type": "mercator"},
  "layer": [
    {
      "data": {"url": "https://raw.githubusercontent.com/JamesCo24/AUS-Airport-Traffic-vs-OTP/refs/heads/main/data/Airport_Traffic.csv"},
      "transform": [
        {"filter": "Month_Selection==null||datum.Month == Month_Selection"},
        {
          "aggregate": [
            {"field": "Dom_Pax_Total", "op": "sum", "as": "State_Pax"},
            {"field": "Dom_Pax_In", "op": "sum", "as": "State_Pax_In"},
            {"field": "Dom_Pax_Out", "op": "sum", "as": "State_Pax_Out"}
          ],
          "groupby": ["State"]
        },
        {
          "lookup": "State",
          "from": {
            "data": {
              "url": "https://raw.githubusercontent.com/JamesCo24/AUS-Airport-Traffic-vs-OTP/refs/heads/main/STE_2021_AUST_GDA2020.json",
              "format": {
                "type": "topojson",
                "feature": "STE_2021_AUST_GDA2020"
              }
            },
            "key": "properties.STE_NAME21"
          },
          "as": "geo"
        },
        {"filter": "State_Selection==null||datum.State==State_Selection"}
      ],
      "mark": {"type": "geoshape", "stroke": "#fff", "strokeWidth": 0.5},
      "encoding": {
        "shape": {"field": "geo", "type": "geojson"},
        "color": {
          "field": "State_Pax",
          "type": "quantitative",
          "title": "State Travellers",
          "scale": {"scheme": "lighttealblue"},
          "legend": {"orient": "left"}
        },
        "tooltip": [
          {"field": "State"},
          {"field": "State_Pax_In", "format": ",", "title": "Incoming Travellers"},
          {"field": "State_Pax_Out", "format": ",", "title": "Outgoing Travellers"},
          {"field": "State_Pax", "format": ",", "title": "Total Travellers"}
        ]
      }
    },
    {
      "data": {"url": "https://raw.githubusercontent.com/JamesCo24/AUS-Airport-Traffic-vs-OTP/refs/heads/main/data/Airport_Traffic.csv"},
      "transform": [
        {"filter": "Month_Selection==null||datum.Month == Month_Selection"},
        {
          "joinaggregate": [
            {"field": "Dom_Pax_Total", "op": "sum", "as": "Airport_Pax"},
            {"field": "Dom_Pax_In", "op": "sum", "as": "Airport_Pax_In"},
            {"field": "Dom_Pax_Out", "op": "sum", "as": "Aiport_Pax_Out"}
          ],
          "groupby": ["Airport"]
        },
        {"filter": "State_Selection==null||datum.State==State_Selection"}
      ],
      "mark": "circle",
      "encoding": {
        "fill": {"value": "violet"},
        "size": {
          "field": "Airport_Pax",
          "type": "quantitative",
          "title": "Airport Travellers",
          "legend": {"orient": "right"}
        },
        "latitude": {"field": "latitude"},
        "longitude": {"field": "longitude"},
        "tooltip": [
          {"field": "Airport"},
          {"field": "Airport_Pax_In", "format": ",", "title": "Incoming Travellers"},
          {"field": "Aiport_Pax_Out", "format": ",", "title": "Outgoing Travellers"},
          {"field": "Airport_Pax", "format": ",", "title": "Total Travellers"}
        ]
      }
    }
  ],
  "config": {}
}